import nvdlib


# Method to get vulnerabilities from NVD
def get_vulnerabilities(software, version):
    # Construct CPE name
    cpe_name = f"cpe:2.3:a:{software}:{software}:{version}:*:*:*:*:*:*"

    # Search for CVEs
    vulnerabilities = nvdlib.searchCVE(cpeName=cpe_name)

    return vulnerabilities


# Method to simplify vulnerability information
def simplify_vulnerability(vulnerability):
    simplified = {
        'url': vulnerability.url,
        'id': vulnerability.id,
        'severity': getattr(vulnerability, 'v31severity') if hasattr(vulnerability, 'v31severity') else getattr(
            vulnerability, 'v2severity', 'Unknown'),
        'score': getattr(vulnerability, 'v31score') if hasattr(vulnerability, 'v31score') else getattr(vulnerability,
                                                                                                       'v2score',
                                                                                                       'Unknown'),
        'description': vulnerability.descriptions[0].value if vulnerability.descriptions else None
    }
    return simplified